{% extends 'base.html.twig' %}
{% block title %}Mon espace — Binajia
{% endblock %}

{% block stylesheets %}
	<style>
		.dashboard-card {
			background: white;
			border-radius: 16px;
			box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
			border: 1px solid rgba(0, 0, 0, 0.05);
			transition: all 0.3s ease;
		}
		.dashboard-card:hover {
			box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
			transform: translateY(-2px);
		}
		.profile-photo {
			transition: all 0.3s ease;
		}
		.profile-photo:hover {
			transform: scale(1.05);
		}
		.member-card-3d {
			background: linear-gradient(135deg, #059669 0%, #047857 100%);
			border-radius: 20px;
			box-shadow: 0 20px 40px rgba(5, 150, 105, 0.3);
			position: relative;
			overflow: hidden;
		}
		.member-card-3d::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
			opacity: 0.6;
		}
		
		/* Mobile optimizations */
		@media (max-width: 768px) {
			.dashboard-card {
				margin: 0 -1rem;
				border-radius: 0;
				border-left: none;
				border-right: none;
			}
			.mobile-sticky-header {
				position: sticky;
				top: 0;
				background: white;
				z-index: 40;
				padding: 1rem 0;
				margin: 0 -1rem;
				padding-left: 1rem;
				padding-right: 1rem;
				border-bottom: 1px solid #e5e7eb;
			}
		}
		
		/* Custom animations */
		@keyframes fadeInUp {
			from {
				opacity: 0;
				transform: translateY(20px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}
		
		.animate-fade-in-up {
			animation: fadeInUp 0.6s ease-out;
		}

		/* Smooth scrolling */
		html {
			scroll-behavior: smooth;
		}
	</style>
{% endblock %}

{% block content %}
	<div class="min-h-screen py-12 bg-gradient-to-br from-yellow-200 via-green-200 to-green-200">
		<!-- Mobile Header -->
		<div class="lg:hidden mobile-sticky-header">
			<div class="flex items-center justify-between">
				<div>
					<h1 class="text-xl font-bold text-gray-900">Tableau de bord</h1>
					<p class="text-sm text-gray-600">Bonjour {{ user.firstName }}</p>
				</div>
				<div class="relative">
					{% set userPhoto = user.carteActuele.photo ?? user.photo %}
					<img src="{{ userPhoto ? path('secure_upload', {'filename': carteActuele.photo|trim('/')}) : '/media/avatar.png' }}" 
						 class="w-12 h-12 rounded-full object-cover border-2 border-white shadow-lg" 
						 alt="{{ user.firstName }}">
				</div>
			</div>
		</div>

		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
			<!-- Desktop Header -->
			<div class="hidden lg:block mb-8">
				<h1 class="text-3xl font-bold text-gray-900 mb-2">Tableau de bord</h1>
				<p class="text-lg text-gray-600">Bienvenue {{ user.firstName }}, gérez votre compte Binajia</p>
			</div>

			<div class="flex flex-col lg:flex-row gap-6">
				<!-- Sidebar - Hidden on mobile, shown on desktop -->
				<aside class="hidden lg:block lg:w-1/4 space-y-6">
					<!-- User Profile Card -->
					<div class="dashboard-card p-6 bg-gradient-to-br from-white to-emerald-50 animate-fade-in-up">
						<div class="flex flex-col items-center text-center space-y-4">
							<div class="relative">
								{% set userPhoto = user.carteActuele.photo ?? user.photo %}
								<img src="{{ userPhoto ? path('secure_upload', {'filename': carteActuele.photo|trim('/')}) : '/media/avatar.png' }}" 
									 class="profile-photo h-24 w-24 rounded-full object-cover border-4 border-white shadow-xl" 
									 alt="{{ user.firstName }} {{ user.lastName }}">
								<div class="absolute -bottom-2 -right-2 h-7 w-7 bg-emerald-500 rounded-full border-2 border-white flex items-center justify-center shadow-lg">
									<svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
										<path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
									</svg>
								</div>
							</div>
							<div>
								<h3 class="font-bold text-lg text-gray-900">{{ user.firstName }} {{ user.lastName }}</h3>
								<p class="text-sm text-gray-500 mt-1">Membre #{{ user.memberId }}</p>
								<p class="text-xs text-emerald-600 font-medium mt-1 flex items-center justify-center">
									<svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
										<path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
									</svg>
									Compte vérifié
								</p>
							</div>
						</div>
					</div>

					<!-- Navigation -->
					<nav class="dashboard-card p-4 bg-white animate-fade-in-up" style="animation-delay: 0.1s">
						<ul class="space-y-2">
							<li>
								<a href="#profile" class="flex items-center px-4 py-3 text-gray-700 rounded-xl hover:bg-emerald-50 hover:text-emerald-700 transition-all duration-200 bg-gray-50">
									<svg class="w-5 h-5 mr-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
									</svg>
									Mon Profil
								</a>
							</li>
							<li>
								<a href="#card" class="flex items-center px-4 py-3 text-gray-700 rounded-xl hover:bg-emerald-50 hover:text-emerald-700 transition-all duration-200">
									<svg class="w-5 h-5 mr-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
									</svg>
									Ma Carte Membre
								</a>
							</li>
							<li>
								<a href="#payments" class="flex items-center px-4 py-3 text-gray-700 rounded-xl hover:bg-emerald-50 hover:text-emerald-700 transition-all duration-200">
									<svg class="w-5 h-5 mr-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
									</svg>
									Mes Paiements
								</a>
							</li>
							<li>
								<a href="#tickets" class="flex items-center px-4 py-3 text-gray-700 rounded-xl hover:bg-emerald-50 hover:text-emerald-700 transition-all duration-200">
									<svg class="w-5 h-5 mr-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"/>
									</svg>
									Mes Tickets
								</a>
							</li>
						</ul>
					</nav>

					<!-- Quick Stats -->
					<div class="dashboard-card p-4 bg-white animate-fade-in-up" style="animation-delay: 0.2s">
						<h4 class="font-semibold text-gray-900 mb-4 flex items-center">
							<svg class="w-5 h-5 mr-2 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
							</svg>
							Statistiques
						</h4>
						<div class="space-y-3">
							<div class="flex justify-between items-center py-2 border-b border-gray-100">
								<span class="text-sm text-gray-600">Paiements</span>
								<span class="font-semibold text-emerald-600 bg-emerald-50 px-2 py-1 rounded-full text-xs">{{ payments|length }}</span>
							</div>
							<div class="flex justify-between items-center py-2 border-b border-gray-100">
								<span class="text-sm text-gray-600">Tickets</span>
								<span class="font-semibold text-blue-600 bg-blue-50 px-2 py-1 rounded-full text-xs">{{ tickets|length }}</span>
							</div>
							<div class="flex justify-between items-center py-2">
								<span class="text-sm text-gray-600">Membre depuis</span>
								<span class="font-semibold text-gray-900 text-sm">{{ user.joinedAt|date('M Y') }}</span>
							</div>
						</div>
					</div>
				</aside>

				<!-- Main Content -->
				<main class="flex-1 space-y-6">
					<!-- Mobile Navigation -->
					<div class="lg:hidden mb-6">
						<div class="flex space-x-2 overflow-x-auto pb-2 -mx-1 px-1">
							<a href="#profile" class="nav-link flex-shrink-0 px-4 py-2 bg-white rounded-xl text-sm font-medium text-gray-700 hover:bg-emerald-50 hover:text-emerald-700 transition-colors border border-gray-200">
								<svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
								</svg>
								Profil
							</a>
							<a href="#card" class="nav-link flex-shrink-0 px-4 py-2 bg-white rounded-xl text-sm font-medium text-gray-700 hover:bg-emerald-50 hover:text-emerald-700 transition-colors border border-gray-200">
								<svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
								</svg>
								Carte
							</a>
							<a href="#payments" class="nav-link flex-shrink-0 px-4 py-2 bg-white rounded-xl text-sm font-medium text-gray-700 hover:bg-emerald-50 hover:text-emerald-700 transition-colors border border-gray-200">
								<svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
								</svg>
								Paiements
							</a>
							<a href="#tickets" class="nav-link flex-shrink-0 px-4 py-2 bg-white rounded-xl text-sm font-medium text-gray-700 hover:bg-emerald-50 hover:text-emerald-700 transition-colors border border-gray-200">
								<svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"/>
								</svg>
								Tickets
							</a>
						</div>
					</div>

					<!-- Profile Section -->
					<section id="profile" class="dashboard-card p-6 animate-fade-in-up">
						<div class="flex items-center justify-between mb-6">
							<h2 class="text-xl lg:text-2xl font-bold text-gray-900 flex items-center">
								<svg class="w-6 h-6 mr-3 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
								</svg>
								Mon Profil
							</h2>
							<button class="px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm lg:text-base">
								<svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
								</svg>
								Modifier
							</button>
						</div>

						<!-- Profile Photo Section -->
						<div class="flex justify-center mb-8">
							<div class="relative">
								{% set userPhoto = user.carteActuele.photo ?? user.photo %}
								<img src="{{ userPhoto ? path('secure_upload', {'filename': carteActuele.photo|trim('/')}) : '/media/avatar.png' }}" 
									 class="profile-photo h-32 w-32 rounded-full object-cover border-4 border-emerald-500 shadow-2xl" 
									 alt="{{ user.firstName }} {{ user.lastName }}">
								<div class="absolute -bottom-2 -right-2 h-10 w-10 bg-emerald-500 rounded-full border-4 border-white flex items-center justify-center shadow-lg">
									<svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
										<path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
									</svg>
								</div>
							</div>
						</div>

						<div class="grid md:grid-cols-2 gap-6">
							<div class="space-y-4">
								<div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
									<label class="text-sm font-medium text-gray-600">Prénom</label>
									<p class="text-lg font-semibold text-gray-900 mt-1">{{ user.firstName }}</p>
								</div>
								<div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
									<label class="text-sm font-medium text-gray-600">Nom</label>
									<p class="text-lg font-semibold text-gray-900 mt-1">{{ user.lastName }}</p>
								</div>
								<div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
									<label class="text-sm font-medium text-gray-600">Pays</label>
									<p class="text-lg font-semibold text-gray-900 mt-1">{{ user.country ?? 'Non renseigné' }}</p>
								</div>
							</div>
							<div class="space-y-4">
								<div class="p-4 bg-emerald-50 rounded-lg border border-emerald-200">
									<label class="text-sm font-medium text-emerald-700">Identifiant Membre</label>
									<p class="text-lg font-bold text-emerald-800 mt-1">{{ user.memberId }}</p>
								</div>
								<div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
									<label class="text-sm font-medium text-blue-700">Membre depuis</label>
									<p class="text-lg font-semibold text-blue-800 mt-1">{{ user.joinedAt|date('d/m/Y') }}</p>
								</div>
								<div class="p-4 bg-amber-50 rounded-lg border border-amber-200">
									<label class="text-sm font-medium text-amber-700">Statut</label>
									<p class="text-lg font-semibold text-amber-800 mt-1 flex items-center">
										<svg class="w-5 h-5 text-emerald-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
											<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
										</svg>
										Actif
									</p>
								</div>
							</div>
						</div>
					</section>

					<!-- Payments Section -->
					<section id="payments" class="dashboard-card p-6 animate-fade-in-up">
						<div class="flex items-center justify-between mb-6">
							<h2 class="text-xl lg:text-2xl font-bold text-gray-900 flex items-center">
								<svg class="w-6 h-6 mr-3 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
								</svg>
								Mes Paiements
							</h2>
							<span class="px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-sm font-medium">
								{{ payments|length }} paiement(s)
							</span>
						</div>

						{% if payments|length > 0 %}
							<div class="overflow-x-auto">
								<table class="min-w-full">
									<thead class="bg-gray-50">
										<tr>
											<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
											<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
											<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Montant</th>
											<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Reçu</th>
										</tr>
									</thead>
									<tbody class="bg-white divide-y divide-gray-200">
										{% for p in payments %}
											<tr class="hover:bg-gray-50 transition-colors">
												<td class="px-4 py-4 whitespace-nowrap text-sm text-gray-900">
													{{ p.date|date('d/m/Y') }}
												</td>
												<td class="px-4 py-4 whitespace-nowrap">
													<div class="flex items-center">
														<svg class="w-4 h-4 text-emerald-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
															<path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
														</svg>
														<span class="text-sm font-medium text-gray-900">{{ p.label }}</span>
													</div>
												</td>
												<td class="px-4 py-4 whitespace-nowrap">
													<span class="text-sm font-bold text-gray-900">{{ p.amount|number_format }} {{ p.currency }}</span>
												</td>
												<td class="px-4 py-4 whitespace-nowrap text-sm">
													{% set receiptUrl = user.receipts[p.id]|default(null) %}
													{% if receiptUrl %}
														<a href="{{ receiptUrl }}" class="inline-flex items-center px-3 py-1 bg-blue-100 text-blue-800 rounded-full hover:bg-blue-200 transition-colors">
															<svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
																<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
															</svg>
															Télécharger
														</a>
													{% else %}
														<span class="text-gray-400">Non disponible</span>
													{% endif %}
												</td>
											</tr>
										{% endfor %}
									</tbody>
								</table>
							</div>
						{% else %}
							<div class="text-center py-12">
								<svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
								</svg>
								<h3 class="text-lg font-medium text-gray-900 mb-2">Aucun paiement</h3>
								<p class="text-gray-500">Vos paiements apparaîtront ici une fois effectués.</p>
							</div>
						{% endif %}
					</section>

					<!-- Tickets Section -->
					<section id="tickets" class="dashboard-card p-6 animate-fade-in-up">
						<div class="flex items-center justify-between mb-6">
							<h2 class="text-xl lg:text-2xl font-bold text-gray-900 flex items-center">
								<svg class="w-6 h-6 mr-3 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"/>
								</svg>
								Mes Tickets
							</h2>
							<span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
								{{ tickets|length }} ticket(s)
							</span>
						</div>

						{% if tickets|length > 0 %}
							<div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
								{% for t in tickets %}
									<div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200 hover:shadow-lg transition-all duration-300">
										<div class="flex items-center justify-between mb-4">
											<svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
												<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
											</svg>
											<span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium">
												{{ t.date|date('d M') }}
											</span>
										</div>
										<h3 class="font-bold text-gray-900 mb-2">{{ t.eventTitle }}</h3>
										<p class="text-sm text-gray-600 mb-4">{{ t.date|date('d/m/Y à H:i') }}</p>
										<button onclick="showTicketQR('{{ t.id }}')" class="w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
											<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
												<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"/>
											</svg>
											Afficher QR
										</button>
									</div>
								{% endfor %}
							</div>
						{% else %}
							<div class="text-center py-12">
								<svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"/>
								</svg>
								<h3 class="text-lg font-medium text-gray-900 mb-2">Aucun ticket</h3>
								<p class="text-gray-500">Vos tickets d'événements apparaîtront ici.</p>
								<a href="{{ path('app_events') }}" class="mt-4 inline-flex items-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors">
									<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
									</svg>
									Découvrir les événements
								</a>
							</div>
						{% endif %}
					</section>

					<!-- Member Card Section -->
					<section id="card" class="dashboard-card p-6 animate-fade-in-up">
						<div class="flex items-center justify-between mb-6">
							<h2 class="text-xl lg:text-2xl font-bold text-gray-900 flex items-center">
								<svg class="w-6 h-6 mr-3 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
								</svg>
								Ma Carte Membre
							</h2>
							{% if user.cardPdf %}
								<a href="{{ user.cardPdf }}" download class="inline-flex items-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors">
									<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
									</svg>
									Télécharger PDF
								</a>
							{% endif %}
						</div>

						<div class="grid lg:grid-cols-2 gap-8 items-center">
							<!-- Digital Card Display -->
							<div class="order-2 lg:order-1">
								<div class="member-card-3d aspect-[1.6/1] p-6 text-white relative">
									<div class="relative z-10 h-full flex flex-col justify-between">
										{% if user.cardPdf %}
											<!-- Aperçu de la carte avec lien vers PDF -->
											<div class="bg-emerald-600 backdrop-blur-sm rounded-lg p-4 h-full flex flex-col justify-center items-center text-center">
												<svg class="w-12 h-12 mb-4 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
													<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
												</svg>
												<h4 class="font-semibold mb-2">Carte de membre BINAJIA</h4>
												<p class="text-sm opacity-90 mb-4">ID: {{ user.memberId }}</p>
												<a href="{{ user.cardPdf }}" class="inline-flex items-center px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-400 transition-colors">
													<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
														<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
														<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
													</svg>
													Voir la carte PDF
												</a>
											</div>
										{% else %}
											<!-- Carte en cours de génération -->
											<div class="bg-white/10 backdrop-blur-sm rounded-lg p-4 h-full flex flex-col justify-center items-center text-center">
												<svg class="w-12 h-12 mb-4 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
													<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
												</svg>
												<h4 class="font-semibold mb-2">Carte en cours de génération</h4>
												<p class="text-sm opacity-90">Votre carte sera bientôt disponible</p>
											</div>
										{% endif %}
									</div>
								</div>
							</div>

							<!-- Card Actions -->
							<div class="order-1 lg:order-2 space-y-4">
								<div class="text-center lg:text-left">
									<h3 class="text-lg font-semibold text-gray-900 mb-2">Votre carte de membre</h3>
									<p class="text-gray-600 mb-4">Présentez cette carte pour bénéficier de vos avantages membres</p>
								</div>

								<div class="space-y-3">
									{% if user.cardPdf %}
										<a href="{{ user.cardPdf }}" download class="w-full flex items-center justify-center px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors">
											<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
												<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
											</svg>
											Télécharger en PDF
										</a>
									{% else %}
										<div class="p-4 bg-amber-50 border border-amber-200 rounded-lg">
											<div class="flex items-center">
												<svg class="w-5 h-5 text-amber-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
													<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"/>
												</svg>
												<span class="text-amber-800">Carte en cours de génération...</span>
											</div>
										</div>
									{% endif %}

									<button onclick="showQRCode()" class="w-full flex items-center justify-center px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
										<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
											<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"/>
										</svg>
										Afficher QR Code
									</button>
								</div>
							</div>
						</div>

						<!-- Card History -->
						{% if cards is defined and cards|length > 0 %}
							<div class="mt-8 pt-6 border-t border-gray-200">
								<h3 class="text-lg font-semibold text-gray-900 mb-4">Historique des cartes</h3>
								<div class="overflow-x-auto">
									<table class="min-w-full">
										<thead class="bg-gray-50">
											<tr>
												<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date d'émission</th>
												<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Expiration</th>
												<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
											</tr>
										</thead>
										<tbody class="bg-white divide-y divide-gray-200">
											{% for c in cards %}
												<tr class="hover:bg-gray-50 transition-colors">
													<td class="px-4 py-4 whitespace-nowrap text-sm text-gray-900">
														{{ c.issuedate ? c.issuedate|date('d/m/Y H:i') : '—' }}
													</td>
													<td class="px-4 py-4 whitespace-nowrap text-sm text-gray-900">
														{{ c.expiryDate ? c.expiryDate|date('d/m/Y') : '—' }}
													</td>
													<td class="px-4 py-4 whitespace-nowrap text-sm">
														{% if c.pdfurl %}
															<a href="{{ c.pdfurl }}" target="_blank" class="inline-flex items-center px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full hover:bg-emerald-200 transition-colors">
																<svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
																	<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
																</svg>
																Télécharger
															</a>
														{% else %}
															<span class="text-gray-400">Non disponible</span>
														{% endif %}
													</td>
												</tr>
											{% endfor %}
										</tbody>
									</table>
								</div>
							</div>
						{% endif %}
					</section>
				</main>
			</div>
		</div>
	</div>

	<script>
		// Mobile navigation
		document.addEventListener('DOMContentLoaded', function () {
			const navLinks = document.querySelectorAll('.nav-link');
			
			navLinks.forEach(link => {
				link.addEventListener('click', function (e) {
					e.preventDefault();
					const targetId = this.getAttribute('href');
					const targetSection = document.querySelector(targetId);

					if (targetSection) {
						// Update active state
						navLinks.forEach(l => {
							l.classList.remove('bg-emerald-100', 'text-emerald-700', 'border-emerald-200');
							l.classList.add('bg-white', 'text-gray-700', 'border-gray-200');
						});
						this.classList.remove('bg-white', 'text-gray-700', 'border-gray-200');
						this.classList.add('bg-emerald-100', 'text-emerald-700', 'border-emerald-200');

						// Smooth scroll
						targetSection.scrollIntoView({
							behavior: 'smooth',
							block: 'start'
						});
					}
				});
			});

			// Add intersection observer for animations
			const observer = new IntersectionObserver((entries) => {
				entries.forEach(entry => {
					if (entry.isIntersecting) {
						entry.target.classList.add('animate-fade-in-up');
					}
				});
			}, {
				threshold: 0.1
			});

			// Observe all dashboard cards
			document.querySelectorAll('.dashboard-card').forEach(card => {
				observer.observe(card);
			});
		});

		// Card functions
		function showQRCode() {
			alert('Fonctionnalité QR Code en développement');
		}

		function showTicketQR(ticketId) {
			alert('QR Code pour le ticket #' + ticketId);
		}
	</script>
{% endblock %}