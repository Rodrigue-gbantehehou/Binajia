{% extends 'base.html.twig' %}
{% block title %}Mon espace ‚Äî Binajia
{% endblock %}

{% block stylesheets %}
	<style>
		.dashboard-card {
			background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
			border-radius: 24px;
			box-shadow: 
				0 4px 6px -1px rgba(0, 0, 0, 0.05),
				0 10px 15px -3px rgba(0, 0, 0, 0.08),
				0 0 0 1px rgba(255, 255, 255, 0.9);
			backdrop-filter: blur(10px);
			border: 1px solid rgba(255, 255, 255, 0.8);
			transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
			position: relative;
			overflow: hidden;
		}
		.dashboard-card::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			height: 4px;
			background: linear-gradient(90deg, #2D7A4F 0%, #F59E0B 50%, #2D7A4F 100%);
			background-size: 200% 100%;
			animation: shimmer 3s ease-in-out infinite;
		}
		.dashboard-card:hover {
			box-shadow: 
				0 20px 25px -5px rgba(0, 0, 0, 0.1),
				0 10px 10px -5px rgba(0, 0, 0, 0.04),
				0 0 0 1px rgba(255, 255, 255, 0.95);
			transform: translateY(-8px) scale(1.02);
		}
		@keyframes shimmer {
			0%, 100% { background-position: -200% 0; }
			50% { background-position: 200% 0; }
		}
		.profile-photo {
			transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
			filter: drop-shadow(0 8px 16px rgba(45, 122, 79, 0.3));
		}
		.profile-photo:hover {
			transform: scale(1.08) rotate(2deg);
			filter: drop-shadow(0 12px 24px rgba(45, 122, 79, 0.4));
		}
		.member-card-3d {
			background: linear-gradient(135deg, #2D7A4F 0%, #1F5438 50%, #0a4b1e 100%);
			border-radius: 20px;
			box-shadow: 
				0 20px 40px rgba(45, 122, 79, 0.4),
				0 0 0 1px rgba(255, 255, 255, 0.1),
				inset 0 1px 0 rgba(255, 255, 255, 0.2);
			position: relative;
			overflow: hidden;
			transform-style: preserve-3d;
			perspective: 1000px;
		}
		.member-card-3d::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: 
				radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
				radial-gradient(circle at 80% 20%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
			opacity: 0.6;
		}
		.member-card-3d::after {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
			transition: left 0.6s ease;
		}
		.member-card-3d:hover::after {
			left: 100%;
		}
		.glass-effect {
			background: rgba(255, 255, 255, 0.1);
			backdrop-filter: blur(20px);
			border: 1px solid rgba(255, 255, 255, 0.2);
			border-radius: 16px;
		}
		.nav-item {
			background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
			border: 1px solid rgba(226, 232, 240, 0.8);
			border-radius: 16px;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			position: relative;
			overflow: hidden;
		}
		.nav-item::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(45, 122, 79, 0.1), transparent);
			transition: left 0.5s ease;
		}
		.nav-item:hover::before {
			left: 100%;
		}
		.nav-item:hover {
			background: linear-gradient(135deg, #2D7A4F 0%, #1F5438 100%);
			color: white;
			transform: translateX(8px);
			box-shadow: 0 8px 25px rgba(45, 122, 79, 0.3);
		}
		.nav-item.active {
			background: linear-gradient(135deg, #2D7A4F 0%, #1F5438 100%);
			color: white;
			box-shadow: 0 8px 25px rgba(45, 122, 79, 0.4);
		}
		.stat-card {
			background: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%);
			border: 1px solid rgba(34, 197, 94, 0.2);
			border-radius: 16px;
			padding: 1.5rem;
			transition: all 0.3s ease;
		}
		.stat-card:hover {
			transform: translateY(-4px);
			box-shadow: 0 12px 24px rgba(34, 197, 94, 0.15);
		}
		@media(max-width: 768px) {
			.dashboard-grid {
				grid-template-columns: 1fr;
			}
			.mobile-nav {
				display: flex;
				overflow-x: auto;
				gap: 0.75rem;
				padding: 1rem;
				background: rgba(255, 255, 255, 0.9);
				backdrop-filter: blur(10px);
				border-radius: 20px;
				box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
				border: 1px solid rgba(255, 255, 255, 0.8);
			}
			.mobile-nav a {
				white-space: nowrap;
				padding: 10px 16px;
				border-radius: 12px;
				background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
				text-decoration: none;
				font-weight: 600;
				color: #374151;
				transition: all 0.3s ease;
				border: 1px solid rgba(226, 232, 240, 0.8);
				flex-shrink: 0;
			}
			.mobile-nav a:hover,
			.mobile-nav a.active {
				background: linear-gradient(135deg, #2D7A4F 0%, #1F5438 100%);
				color: white;
				transform: scale(1.05);
				box-shadow: 0 4px 12px rgba(45, 122, 79, 0.3);
			}
		}
		.floating-bg {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: 
				radial-gradient(circle at 20% 80%, rgba(45, 122, 79, 0.1) 0%, transparent 50%),
				radial-gradient(circle at 80% 20%, rgba(245, 158, 11, 0.1) 0%, transparent 50%),
				linear-gradient(135deg, #f0fdf4 0%, #fffbeb 50%, #f0fdf4 100%);
			z-index: -1;
		}
		.floating-shapes {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			overflow: hidden;
			z-index: -1;
		}
		.floating-shapes::before,
		.floating-shapes::after {
			content: '';
			position: absolute;
			border-radius: 50%;
			background: linear-gradient(135deg, rgba(45, 122, 79, 0.1) 0%, rgba(245, 158, 11, 0.1) 100%);
			animation: float 6s ease-in-out infinite;
		}
		.floating-shapes::before {
			width: 200px;
			height: 200px;
			top: 10%;
			left: 5%;
			animation-delay: 0s;
		}
		.floating-shapes::after {
			width: 150px;
			height: 150px;
			top: 60%;
			right: 5%;
			animation-delay: -2s;
		}
		@keyframes float {
			0%, 100% { transform: translateY(0px) rotate(0deg); }
			50% { transform: translateY(-20px) rotate(180deg); }
		}
	</style>
{% endblock %}

{% block content %}
	<div class="min-h-screen py-8 relative">
		<!-- Background Elements -->
		<div class="floating-bg"></div>
		<div class="floating-shapes"></div>

		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
			<!-- Header -->
			<div class="mb-12 text-center">
				<h1 class="text-4xl font-bold bg-gradient-to-r from-green-600 to-orange-500 bg-clip-text text-transparent mb-4">
					Tableau de Bord
				</h1>
				<p class="text-xl text-gray-600 max-w-2xl mx-auto">
					Bienvenue <span class="font-semibold text-green-600">{{ user.firstName }}</span>, 
					g√©rez votre espace membre Binajia
				</p>
			</div>

			<!-- Mobile Navigation -->
			<div class="lg:hidden mb-8 mobile-nav">
				<a href="#profile" class="nav-link active">üë§ Profil</a>
				<a href="#card" class="nav-link">üí≥ Ma Carte</a>
				<a href="#payments" class="nav-link">üí∞ Paiements</a>
				<a href="#tickets" class="nav-link">üé´ Tickets</a>
			</div>

			<div class="dashboard-grid grid lg:grid-cols-12 gap-8">
				<!-- Sidebar -->
				<aside class="lg:col-span-3 space-y-6 hidden lg:block">
					<!-- User Profile Card -->
					<div class="dashboard-card p-8 text-center">
						<div class="flex flex-col items-center space-y-6">
							<div class="relative">
								{% set userPhoto = user.carteActuele.photo ?? user.photo %}
								<img src="{{ userPhoto ? path('secure_upload', {'filename': carteActuele.photo|trim('/')}) : '/media/avatar.png' }}" 
									class="profile-photo h-32 w-32 rounded-full object-cover border-4 border-white shadow-2xl" 
									alt="{{ user.firstName }} {{ user.lastName }}">
								<div class="absolute -bottom-2 -right-2 h-12 w-12 bg-gradient-to-r from-green-500 to-orange-400 rounded-full border-4 border-white flex items-center justify-center shadow-lg">
									<i class="fas fa-crown text-white text-sm"></i>
								</div>
							</div>
							<div class="space-y-3">
								<h3 class="font-bold text-2xl text-gray-900">{{ user.firstName }} {{ user.lastName }}</h3>
								<p class="text-sm text-gray-500">Membre #{{ user.memberId }}</p>
								<div class="flex items-center justify-center space-x-2">
									<span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold flex items-center">
										<i class="fas fa-shield-check mr-1"></i>V√©rifi√©
									</span>
									<span class="px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-xs font-semibold">
										Premium
									</span>
								</div>
							</div>
						</div>
					</div>

					<!-- Navigation -->
					<nav class="dashboard-card p-6">
						<ul class="space-y-3">
							<li>
								<a href="#profile" class="nav-item flex items-center px-4 py-4 text-gray-700 rounded-xl transition-all duration-300">
									<i class="fas fa-user-circle mr-4 text-lg text-green-600"></i>
									<span class="font-semibold">Mon Profil</span>
								</a>
							</li>
							<li>
								<a href="#card" class="nav-item flex items-center px-4 py-4 text-gray-700 rounded-xl transition-all duration-300">
									<i class="fas fa-id-card mr-4 text-lg text-blue-600"></i>
									<span class="font-semibold">Ma Carte Membre</span>
								</a>
							</li>
							<li>
								<a href="#payments" class="nav-item flex items-center px-4 py-4 text-gray-700 rounded-xl transition-all duration-300">
									<i class="fas fa-credit-card mr-4 text-lg text-purple-600"></i>
									<span class="font-semibold">Mes Paiements</span>
								</a>
							</li>
							<li>
								<a href="#tickets" class="nav-item flex items-center px-4 py-4 text-gray-700 rounded-xl transition-all duration-300">
									<i class="fas fa-ticket-alt mr-4 text-lg text-orange-600"></i>
									<span class="font-semibold">Mes Tickets</span>
								</a>
							</li>
						</ul>
					</nav>

					<!-- Quick Stats -->
					<div class="dashboard-card p-6">
						<h4 class="font-bold text-gray-900 mb-4 text-lg">Statistiques</h4>
						<div class="space-y-4">
							<div class="stat-card">
								<div class="flex items-center justify-between">
									<div>
										<p class="text-sm text-gray-600">Paiements</p>
										<p class="text-2xl font-bold text-green-600 mt-1">{{ payments|length }}</p>
									</div>
									<div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
										<i class="fas fa-credit-card text-green-600 text-xl"></i>
									</div>
								</div>
							</div>
							<div class="stat-card">
								<div class="flex items-center justify-between">
									<div>
										<p class="text-sm text-gray-600">Tickets</p>
										<p class="text-2xl font-bold text-blue-600 mt-1">{{ tickets|length }}</p>
									</div>
									<div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center">
										<i class="fas fa-ticket-alt text-blue-600 text-xl"></i>
									</div>
								</div>
							</div>
							<div class="stat-card">
								<div class="flex items-center justify-between">
									<div>
										<p class="text-sm text-gray-600">Membre depuis</p>
										<p class="text-lg font-bold text-gray-900 mt-1">{{ user.joinedAt|date('M Y') }}</p>
									</div>
									<div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center">
										<i class="fas fa-calendar text-orange-600 text-xl"></i>
									</div>
								</div>
							</div>
						</div>
					</div>
				</aside>

				<!-- Main Content -->
				<main class="lg:col-span-9 space-y-8">
					<!-- Profile Section -->
					<section id="profile" class="dashboard-card p-8">
						<div class="flex items-center justify-between mb-8">
							<h2 class="text-3xl font-bold bg-gradient-to-r from-green-600 to-orange-500 bg-clip-text text-transparent flex items-center">
								<i class="fas fa-user-circle mr-4"></i>Mon Profil
							</h2>
							<button class="px-6 py-3 bg-gradient-to-r from-green-600 to-orange-500 text-white rounded-xl font-semibold hover:shadow-lg transition-all duration-300 hover:scale-105">
								<i class="fas fa-edit mr-2"></i>Modifier
							</button>
						</div>

						<!-- Profile Photo Section -->
						<div class="flex justify-center mb-8">
							<div class="relative">
								{% set userPhoto = user.carteActuele.photo ?? user.photo %}
								<img src="{{ userPhoto ? path('secure_upload', {'filename': carteActuele.photo|trim('/')}) : '/media/avatar.png' }}" 
									class="profile-photo h-36 w-36 rounded-full object-cover border-4 border-green-500 shadow-2xl" 
									alt="{{ user.firstName }} {{ user.lastName }}">
								<div class="absolute -bottom-2 -right-2 h-12 w-12 bg-gradient-to-r from-green-500 to-orange-400 rounded-full border-4 border-white flex items-center justify-center shadow-lg">
									<i class="fas fa-check text-white"></i>
								</div>
							</div>
						</div>

						<div class="grid md:grid-cols-2 gap-6">
							<div class="space-y-4">
								<div class="p-6 bg-gradient-to-br from-gray-50 to-white rounded-2xl border border-gray-200">
									<label class="text-sm font-semibold text-gray-600">Pr√©nom</label>
									<p class="text-xl font-bold text-gray-900 mt-2">{{ user.firstName }}</p>
								</div>
								<div class="p-6 bg-gradient-to-br from-gray-50 to-white rounded-2xl border border-gray-200">
									<label class="text-sm font-semibold text-gray-600">Nom</label>
									<p class="text-xl font-bold text-gray-900 mt-2">{{ user.lastName }}</p>
								</div>
								<div class="p-6 bg-gradient-to-br from-gray-50 to-white rounded-2xl border border-gray-200">
									<label class="text-sm font-semibold text-gray-600">Pays</label>
									<p class="text-xl font-bold text-gray-900 mt-2">{{ user.country ?? 'Non renseign√©' }}</p>
								</div>
							</div>
							<div class="space-y-4">
								<div class="p-6 bg-gradient-to-br from-green-50 to-white rounded-2xl border border-green-200">
									<label class="text-sm font-semibold text-green-700">Identifiant Membre</label>
									<p class="text-xl font-bold text-green-800 mt-2">{{ user.memberId }}</p>
								</div>
								<div class="p-6 bg-gradient-to-br from-blue-50 to-white rounded-2xl border border-blue-200">
									<label class="text-sm font-semibold text-blue-700">Membre depuis</label>
									<p class="text-xl font-bold text-blue-800 mt-2">{{ user.joinedAt|date('d/m/Y') }}</p>
								</div>
								<div class="p-6 bg-gradient-to-br from-orange-50 to-white rounded-2xl border border-orange-200">
									<label class="text-sm font-semibold text-orange-700">Statut</label>
									<p class="text-xl font-bold text-orange-800 mt-2 flex items-center">
										<i class="fas fa-check-circle text-green-500 mr-3 text-2xl"></i>Actif
									</p>
								</div>
							</div>
						</div>
					</section>

					<!-- Rest of the sections (Payments, Tickets, Member Card) remain the same but with updated card styling -->
					<!-- Payments Section -->
					<section id="payments" class="dashboard-card p-8">
						<div class="flex items-center justify-between mb-8">
							<h2 class="text-3xl font-bold bg-gradient-to-r from-green-600 to-orange-500 bg-clip-text text-transparent flex items-center">
								<i class="fas fa-credit-card mr-4"></i>Mes Paiements
							</h2>
							<span class="px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-semibold">
								{{ payments|length }} paiement(s)
							</span>
						</div>

						<!-- Payments content remains the same -->
						{% if payments|length > 0 %}
							<div class="overflow-x-auto">
								<table class="min-w-full">
									<thead class="bg-gray-50">
										<tr>
											<th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Date</th>
											<th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Description</th>
											<th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Montant</th>
											<th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Re√ßu</th>
										</tr>
									</thead>
									<tbody class="bg-white divide-y divide-gray-200">
										{% for p in payments %}
											<tr class="hover:bg-gray-50 transition-colors">
												<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
													{{ p.date|date('d/m/Y') }}
												</td>
												<td class="px-6 py-4 whitespace-nowrap">
													<div class="flex items-center">
														<i class="fas fa-circle-check text-green-500 mr-3"></i>
														<span class="text-sm font-medium text-gray-900">{{ p.label }}</span>
													</div>
												</td>
												<td class="px-6 py-4 whitespace-nowrap">
													<span class="text-sm font-bold text-gray-900">{{ p.amount|number_format }} {{ p.currency }}</span>
												</td>
												<td class="px-6 py-4 whitespace-nowrap text-sm">
													{% set receiptUrl = user.receipts[p.id]|default(null) %}
													{% if receiptUrl %}
														<a href="{{ receiptUrl }}" class="inline-flex items-center px-4 py-2 bg-blue-100 text-blue-800 rounded-xl hover:bg-blue-200 transition-colors font-semibold">
															<i class="fas fa-receipt mr-2"></i>T√©l√©charger
														</a>
													{% else %}
														<span class="text-gray-400">Non disponible</span>
													{% endif %}
												</td>
											</tr>
										{% endfor %}
									</tbody>
								</table>
							</div>
						{% else %}
							<div class="text-center py-12">
								<i class="fas fa-credit-card text-gray-300 text-6xl mb-4"></i>
								<h3 class="text-xl font-semibold text-gray-900 mb-2">Aucun paiement</h3>
								<p class="text-gray-500">Vos paiements appara√Ætront ici une fois effectu√©s.</p>
							</div>
						{% endif %}
					</section>

					<!-- Tickets Section -->
					<section id="tickets" class="dashboard-card p-8">
						<div class="flex items-center justify-between mb-8">
							<h2 class="text-3xl font-bold bg-gradient-to-r from-green-600 to-orange-500 bg-clip-text text-transparent flex items-center">
								<i class="fas fa-ticket-alt mr-4"></i>Mes Tickets
							</h2>
							<span class="px-4 py-2 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold">
								{{ tickets|length }} ticket(s)
							</span>
						</div>

						{% if tickets|length > 0 %}
							<div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
								{% for t in tickets %}
									<div class="bg-gradient-to-br from-blue-50 to-indigo-100 p-6 rounded-2xl border border-blue-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
										<div class="flex items-center justify-between mb-4">
											<i class="fas fa-calendar-alt text-blue-600 text-2xl"></i>
											<span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-semibold">
												{{ t.date|date('d M') }}
											</span>
										</div>
										<h3 class="font-bold text-gray-900 mb-2 text-lg">{{ t.eventTitle }}</h3>
										<p class="text-sm text-gray-600 mb-4">{{ t.date|date('d/m/Y √† H:i') }}</p>
										<button onclick="showTicketQR('{{ t.id }}')" class="w-full flex items-center justify-center px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:shadow-lg transition-all duration-300 hover:scale-105 font-semibold">
											<i class="fas fa-qrcode mr-2"></i>Afficher QR
										</button>
									</div>
								{% endfor %}
							</div>
						{% else %}
							<div class="text-center py-12">
								<i class="fas fa-ticket-alt text-gray-300 text-6xl mb-4"></i>
								<h3 class="text-xl font-semibold text-gray-900 mb-2">Aucun ticket</h3>
								<p class="text-gray-500 mb-6">Vos tickets d'√©v√©nements appara√Ætront ici.</p>
								<a href="{{ path('app_events') }}" class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-green-600 to-orange-500 text-white rounded-xl hover:shadow-lg transition-all duration-300 hover:scale-105 font-semibold">
									<i class="fas fa-calendar-plus mr-2"></i>D√©couvrir les √©v√©nements
								</a>
							</div>
						{% endif %}
					</section>

					<!-- Member Card Section -->
					<section id="card" class="dashboard-card p-8">
						<div class="flex items-center justify-between mb-8">
							<h2 class="text-3xl font-bold bg-gradient-to-r from-green-600 to-orange-500 bg-clip-text text-transparent flex items-center">
								<i class="fas fa-id-card mr-4"></i>Ma Carte Membre
							</h2>
							{% if user.cardPdf %}
								<a href="{{ user.cardPdf }}" download class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-green-600 to-orange-500 text-white rounded-xl hover:shadow-lg transition-all duration-300 hover:scale-105 font-semibold">
									<i class="fas fa-download mr-2"></i>T√©l√©charger PDF
								</a>
							{% endif %}
						</div>

						<div class="grid lg:grid-cols-2 gap-8 items-center">
							<!-- Digital Card Display -->
							<div class="order-2 lg:order-1">
								<div class="member-card-3d aspect-[1.6/1] p-8 text-white relative">
									<div class="relative z-10 h-full flex flex-col justify-between">
										{% if user.cardPdf %}
											<div class="glass-effect p-6 h-full flex flex-col justify-center items-center text-center">
												<i class="fas fa-id-card text-5xl mb-4 opacity-80"></i>
												<h4 class="font-bold text-xl mb-2">Carte de membre BINAJIA</h4>
												<p class="text-sm opacity-90 mb-4">ID: {{ user.memberId }}</p>
												<a href="{{ user.cardPdf }}" class="inline-flex items-center px-6 py-3 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 transition-all duration-300 font-semibold">
													<i class="fas fa-eye mr-2"></i>Voir la carte PDF
												</a>
											</div>
										{% else %}
											<div class="glass-effect p-6 h-full flex flex-col justify-center items-center text-center">
												<i class="fas fa-clock text-5xl mb-4 opacity-80"></i>
												<h4 class="font-bold text-xl mb-2">Carte en cours de g√©n√©ration</h4>
												<p class="text-sm opacity-90">Votre carte sera bient√¥t disponible</p>
											</div>
										{% endif %}
									</div>
								</div>
							</div>

							<!-- Card Actions -->
							<div class="order-1 lg:order-2 space-y-6">
								<div class="text-center lg:text-left">
									<h3 class="text-2xl font-bold text-gray-900 mb-3">Votre carte de membre</h3>
									<p class="text-gray-600 text-lg">Pr√©sentez cette carte pour b√©n√©ficier de vos avantages membres exclusifs</p>
								</div>

								<div class="space-y-4">
									{% if user.cardPdf %}
										<a href="{{ user.cardPdf }}" download class="w-full flex items-center justify-center px-6 py-4 bg-gradient-to-r from-green-600 to-orange-500 text-white rounded-xl hover:shadow-xl transition-all duration-300 hover:scale-105 font-semibold text-lg">
											<i class="fas fa-file-pdf mr-3 text-xl"></i>
											T√©l√©charger en PDF
										</a>
									{% else %}
										<div class="p-6 bg-yellow-50 border border-yellow-200 rounded-2xl">
											<div class="flex items-center">
												<i class="fas fa-exclamation-triangle text-yellow-600 mr-3 text-xl"></i>
												<span class="text-yellow-800 font-semibold">Carte en cours de g√©n√©ration...</span>
											</div>
										</div>
									{% endif %}

									<button onclick="showQRCode()" class="w-full flex items-center justify-center px-6 py-4 bg-gradient-to-r from-gray-600 to-gray-500 text-white rounded-xl hover:shadow-xl transition-all duration-300 hover:scale-105 font-semibold text-lg">
										<i class="fas fa-qrcode mr-3 text-xl"></i>Afficher QR Code
									</button>
								</div>
							</div>
						</div>

						<!-- Card History -->
						{% if cards is defined and cards|length > 0 %}
							<div class="mt-12 pt-8 border-t border-gray-200">
								<h3 class="text-2xl font-bold text-gray-900 mb-6">Historique des cartes</h3>
								<div class="overflow-x-auto">
									<table class="min-w-full">
										<thead class="bg-gray-50">
											<tr>
												<th class="px-6 py-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Date d'√©mission</th>
												<th class="px-6 py-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Expiration</th>
												<th class="px-6 py-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Actions</th>
											</tr>
										</thead>
										<tbody class="bg-white divide-y divide-gray-200">
											{% for c in cards %}
												<tr class="hover:bg-gray-50 transition-colors">
													<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
														{{ c.issuedate ? c.issuedate|date('d/m/Y H:i') : '‚Äî' }}
													</td>
													<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
														{{ c.expiryDate ? c.expiryDate|date('d/m/Y') : '‚Äî' }}
													</td>
													<td class="px-6 py-4 whitespace-nowrap text-sm">
														{% if c.pdfurl %}
															<a href="{{ c.pdfurl }}" target="_blank" class="inline-flex items-center px-4 py-2 bg-green-100 text-green-800 rounded-xl hover:bg-green-200 transition-colors font-semibold">
																<i class="fas fa-download mr-2"></i>T√©l√©charger
															</a>
														{% else %}
															<span class="text-gray-400">Non disponible</span>
														{% endif %}
													</td>
												</tr>
											{% endfor %}
										</tbody>
									</table>
								</div>
							</div>
						{% endif %}
					</section>
				</main>
			</div>
		</div>
	</div>

	<script>
		// Mobile navigation
		document.addEventListener('DOMContentLoaded', function () {
			const navLinks = document.querySelectorAll('.mobile-nav .nav-link, nav a[href^="#"]');

			navLinks.forEach(link => {
				link.addEventListener('click', function (e) {
					e.preventDefault();
					const targetId = this.getAttribute('href');
					const targetSection = document.querySelector(targetId);

					if (targetSection) {
						// Update active state
						navLinks.forEach(l => l.classList.remove('active'));
						this.classList.add('active');

						// Smooth scroll
						targetSection.scrollIntoView({behavior: 'smooth', block: 'start'});
					}
				});
			});
		});

		// Card functions
		function printCard() {
			window.print();
		}

		function showQRCode() {
			alert('Fonctionnalit√© QR Code en d√©veloppement');
		}

		function showTicketQR(ticketId) {
			alert('QR Code pour le ticket #' + ticketId);
		}

		// Enhanced animations
		const observerOptions = {
			threshold: 0.1,
			rootMargin: '0px 0px -50px 0px'
		};

		const observer = new IntersectionObserver((entries) => {
			entries.forEach(entry => {
				if (entry.isIntersecting) {
					entry.target.style.opacity = '1';
					entry.target.style.transform = 'translateY(0) scale(1)';
				}
			});
		}, observerOptions);

		// Observe dashboard cards with enhanced animations
		document.addEventListener('DOMContentLoaded', function () {
			const cards = document.querySelectorAll('.dashboard-card');
			cards.forEach((card, index) => {
				card.style.opacity = '0';
				card.style.transform = 'translateY(30px) scale(0.95)';
				card.style.transition = `opacity 0.8s ease ${
					index * 0.15
				}s, transform 0.8s ease ${
					index * 0.15
				}s, box-shadow 0.4s ease`;
				observer.observe(card);
			});

			// Add floating animation to profile photo
			const profilePhoto = document.querySelector('.profile-photo');
			if (profilePhoto) {
				setInterval(() => {
					profilePhoto.style.transform = `scale(${1 + Math.sin(Date.now() / 1000) * 0.02}) rotate(${Math.sin(Date.now() / 1500) * 0.5}deg)`;
				}, 50);
			}
		});
	</script>
{% endblock %}