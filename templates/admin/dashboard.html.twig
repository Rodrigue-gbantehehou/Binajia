{% extends 'admin/base.html.twig' %}

{# Fallback KPIs if controller didn't provide them #}
{% set kpis = kpis|default([
  { label: 'Revenus 30j', value: '—' },
  { label: 'Nouveaux membres', value: '—' },
  { label: 'Cartes générées', value: '—' },
  { label: 'Erreurs 24h', value: '—' }
]) %}

{% block admin_body %}
  <!-- Stats Cards -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
    <div class="bg-white rounded-lg shadow p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500">Membres totaux</p>
          <h3 class="text-2xl font-bold">{{ stats.totalMembers|default('—') }}</h3>
          <p class="text-green-500 text-sm">{{ stats.membersGrowth|default('+0% ce mois') }}</p>
        </div>
        <div class="bg-indigo-100 text-indigo-800 p-3 rounded-full">
          <i class="fas fa-users text-xl"></i>
        </div>
      </div>
    </div>
    <div class="bg-white rounded-lg shadow p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500">Événements</p>
          <h3 class="text-2xl font-bold">{{ stats.eventsCount|default('—') }}</h3>
          <p class="text-green-500 text-sm">{{ stats.newEvents|default('+0 nouveaux') }}</p>
        </div>
        <div class="bg-yellow-100 text-yellow-800 p-3 rounded-full">
          <i class="fas fa-calendar-alt text-xl"></i>
        </div>
      </div>
    </div>
    <div class="bg-white rounded-lg shadow p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500">Revenus</p>
          <h3 class="text-2xl font-bold">{{ stats.revenueTotal|default('—') }}</h3>
          <p class="text-green-500 text-sm">{{ stats.revenueGrowth|default('+0% ce mois') }}</p>
        </div>
        <div class="bg-green-100 text-green-800 p-3 rounded-full">
          <i class="fas fa-money-bill-wave text-xl"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activities -->
  <div class="bg-white rounded-lg shadow p-6 mb-6">
    <h2 class="text-xl font-bold mb-4">Activités récentes</h2>
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Utilisateur</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Statut</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          {% set activities = activities|default([
            { name: 'Admin User', email: 'admin@binajia.org', avatar: '/media/avatar.png', action: "Création d'événement", date: '—', status: 'Complété' },
            { name: 'Manager User', email: 'manager@binajia.org', avatar: '/media/avatar.png', action: 'Modification membre', date: '—', status: 'Complété' },
            { name: 'Employee User', email: 'employee@binajia.org', avatar: '/media/avatar.png', action: 'Nouvelle réservation', date: '—', status: 'En attente' }
          ]) %}
          {% for a in activities %}
          <tr>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center">
                <img class="h-10 w-10 rounded-full object-cover" src="{{ a.avatar }}" alt="">
                <div class="ml-4">
                  <div class="text-sm font-medium text-gray-900">{{ a.name }}</div>
                  <div class="text-sm text-gray-500">{{ a.email }}</div>
                </div>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ a.action }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ a.date }}</td>
            <td class="px-6 py-4 whitespace-nowrap">
              {% set ok = a.status == 'Complété' %}
              <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full {{ ok ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800' }}">{{ a.status }}</span>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
    <a href="#" class="bg-white rounded-lg shadow p-6 flex flex-col items-center justify-center hover:shadow-lg transition">
      <div class="bg-indigo-100 text-indigo-800 p-4 rounded-full mb-3">
        <i class="fas fa-user-plus text-2xl"></i>
      </div>
      <h3 class="font-bold text-center">Ajouter un membre</h3>
    </a>
    <a href="#" class="bg-white rounded-lg shadow p-6 flex flex-col items-center justify-center hover:shadow-lg transition">
      <div class="bg-yellow-100 text-yellow-800 p-4 rounded-full mb-3">
        <i class="fas fa-calendar-plus text-2xl"></i>
      </div>
      <h3 class="font-bold text-center">Créer un événement</h3>
    </a>
    <a href="#" class="bg-white rounded-lg shadow p-6 flex flex-col items-center justify-center hover:shadow-lg transition">
      <div class="bg-green-100 text-green-800 p-4 rounded-full mb-3">
        <i class="fas fa-file-invoice-dollar text-2xl"></i>
      </div>
      <h3 class="font-bold text-center">Générer un rapport</h3>
    </a>
    <a href="#" class="bg-white rounded-lg shadow p-6 flex flex-col items-center justify-center hover:shadow-lg transition">
      <div class="bg-blue-100 text-blue-800 p-4 rounded-full mb-3">
        <i class="fas fa-cog text-2xl"></i>
      </div>
      <h3 class="font-bold text-center">Paramètres</h3>
    </a>
  </div>
{% endblock %}
